{% extends "base.html" %}

{% block id %}schema{% endblock %}

{% block content %}

<h2>{{ schema.slug }}</h2>

<div><a href="{{ schema.json_url }}">JSON</a></div>

{% if schema.api_key and schema.current_user_is_owner %}
<p>APIキー<input type="text" readonly="readonly" class="api_key" value="{{ schema.api_key }}" size="60" ></input></p>
<a href="{{ schema.setting_url }}">設定</a>
{% endif %}

{% if schema.has_data %}
<h2>グラフ</h2>
<div id="chart" style="height:300px;width:500px; "></div>
{% endif %}

<h2>投稿</h2>
{% if schema.current_user_can_post %}
<form method="POST" action="{{ schema_url }}">
  <!-- <input type="text" name="group" placeholder="group" /> -->
  <textarea name="value" placeholder="value" rows="10" cols="80" ></textarea>
  {% if schema.api_key %}
  <input type="hidden" name="api_key" value="{{ schema.api_key }}" />
  {% endif %}
  <br>
  <input type="submit" value="作る">
</form>
{% else %}
  <p>このスキーマに投稿するにはAPIキーが必要です．</p>
{% endif %}

<h2>データ</h2>
<div class="autopagerize_page_element">
  <ul class="data-list">
    {% for data in pager.data %}
    <li>
      {% include "macro/data_item.html" %}
    </li>
    {% endfor %}
  </ul>

  {% if pager.has_prev %}
  <a href="{{ schema.url}}?page={{pager.prev_page}}" rel="prev" >prev</a>
  {% endif %}
  {% if pager.has_next %}
  <a href="{{ schema.url}}?page={{pager.next_page}}" rel="next" >next</a>
  {% endif %}
</div>

<div class="autopagerize_insert_before"></div>

{% endblock %}
